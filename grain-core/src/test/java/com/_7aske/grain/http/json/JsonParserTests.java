package com._7aske.grain.http.json;

import com._7aske.grain.http.json.nodes.JsonNode;
import org.junit.jupiter.api.Test;

import static org.junit.jupiter.api.Assertions.*;

class JsonParserTests {

    @Test
    void test_validJsonObjectParsed() {
        JsonParser deserializer = new JsonParser();
        String json = "{\"valid_auth\":false,\"count\":1,\"limit\":1,\"total\":139,\"last_page\":139,\"result\":[{\"id\":2582,\"cospar_id\":\"\",\"sort_date\":\"1631750396\",\"name\":\"Inspiration4\",\"provider\":{\"id\":1,\"name\":\"SpaceX\",\"slug\":\"spacex\"},\"vehicle\":{\"id\":1,\"name\":\"Falcon 9\",\"company_id\":1,\"slug\":\"falcon-9\"},\"pad\":{\"id\":2,\"name\":\"LC-39A\",\"location\":{\"id\":61,\"name\":\"Kennedy Space Center\",\"state\":\"FL\",\"statename\":\"Florida\",\"country\":\"United States\",\"slug\":\"kennedy-space-center\"}},\"missions\":[{\"id\":4026,\"name\":\"Inspiration4\",\"description\":null}],\"mission_description\":null,\"launch_description\":\"A SpaceX Falcon 9 rocket will launch the Inspiration4 mission. The launch date is currently targeted for September 15, 2021 (UTC).\",\"win_open\":null,\"t0\":null,\"win_close\":null,\"est_date\":{\"month\":9,\"day\":15,\"year\":2021,\"quarter\":null},\"date_str\":\"Sep 15\",\"tags\":[{\"id\":9,\"text\":\"Crewed\"},{\"id\":18,\"text\":\"Tourism\"}],\"slug\":\"inspiration4\",\"weather_summary\":null,\"weather_temp\":null,\"weather_condition\":null,\"weather_wind_mph\":null,\"weather_icon\":null,\"weather_updated\":null,\"quicktext\":\"Falcon 9 - Inspiration4 - Sep 15 (estimated) - https:\\/\\/rocketlaunch.live\\/launch\\/inspiration4 for info\\/stream\",\"media\":[],\"result\":-1,\"suborbital\":false,\"modified\":\"2021-03-30T14:27:13+00:00\"}], \"empty\":{}}";
        JsonNode test = deserializer.parse(json);
        System.out.println(test);
        assertFalse(test.get("valid_auth").getBoolean());
        assertEquals(1, test.get("count").getValue());
        assertEquals(1, test.get("limit").getValue());
        assertEquals(139, test.get("total").getValue());
        assertEquals(2582, test.get("result").asArray().get(0).get("id").getValue());
        assertEquals("", test.get("result").asArray().get(0).get("cospar_id").getValue());
        assertEquals("1631750396", test.get("result").asArray().get(0).get("sort_date").getValue());
        assertEquals("Inspiration4", test.get("result").asArray().get(0).get("name").getValue());
        assertEquals(1, test.get("result").asArray().get(0).get("provider").get("id").getValue());
        assertEquals("SpaceX", test.get("result").asArray().get(0).get("provider").get("name").getValue());
        assertEquals(1, test.get("result").asArray().get(0).get("vehicle").get("id").getValue());
        assertEquals("Falcon 9", test.get("result").asArray().get(0).get("vehicle").get("name").getValue());
        assertEquals(4026, test.get("result").asArray().get(0).get("missions").asArray().get(0).get("id").getValue());
        assertNull(test.get("result").asArray().get(0).get("missions").asArray().get(0).get("description").getValue());
        assertEquals(18, test.get("result").asArray().get(0).get("tags").asArray().get(1).get("id").getValue());
    }

    @Test
    void test_emoji() {
        JsonParser deserializer = new JsonParser();
        String json = "{\"emoji\": \" ğŸ‘ \"}";
        JsonNode test = deserializer.parse(json);
        System.out.println(test);
        assertEquals(" ğŸ‘ ", test.get("emoji").getValue());
    }

    @Test
    void test_utf8() {
        String longText = "Sentences that contain all letters commonly used in a language\\n                --------------------------------------------------------------\\n                    \\n                Markus Kuhn <http://www.cl.cam.ac.uk/~mgk25/> -- 2012-04-11\\n                    \\n                This is an example of a plain-text file encoded in UTF-8.\\n                    \\n                    \\n                Danish (da)\\n                ---------\\n                    \\n                  Quizdeltagerne spiste jordbÃ¦r med flÃ¸de, mens cirkusklovnen\\n                  Wolther spillede pÃ¥ xylofon.\\n                  (= Quiz contestants were eating strawbery with cream while Wolther\\n                  the circus clown played on xylophone.)\\n                    \\n                German (de)\\n                -----------\\n                    \\n                  Falsches Ãœben von Xylophonmusik quÃ¤lt jeden grÃ¶ÃŸeren Zwerg\\n                  (= Wrongful practicing of xylophone music tortures every larger dwarf)\\n                    \\n                  ZwÃ¶lf BoxkÃ¤mpfer jagten Eva quer Ã¼ber den Sylter Deich\\n                  (= Twelve boxing fighters hunted Eva across the dike of Sylt)\\n                    \\n                  HeizÃ¶lrÃ¼ckstoÃŸabdÃ¤mpfung\\n                  (= fuel oil recoil absorber)\\n                  (jqvwxy missing, but all non-ASCII letters in one word)\\n                    \\n                Greek (el)\\n                ----------\\n                    \\n                  Î“Î±Î¶Î­ÎµÏ‚ ÎºÎ±á½¶ Î¼Ï…ÏÏ„Î¹á½²Ï‚ Î´á½²Î½ Î¸á½° Î²Ïá¿¶ Ï€Î¹á½° ÏƒÏ„á½¸ Ï‡ÏÏ…ÏƒÎ±Ï†á½¶ Î¾Î­Ï†Ï‰Ï„Î¿\\n                  (= No more shall I see acacias or myrtles in the golden clearing)\\n                    \\n                  ÎÎµÏƒÎºÎµÏ€Î¬Î¶Ï‰ Ï„á½´Î½ ÏˆÏ…Ï‡Î¿Ï†Î¸ÏŒÏÎ± Î²Î´ÎµÎ»Ï…Î³Î¼Î¯Î±\\n                  (= I uncover the soul-destroying abhorrence)\\n                    \\n                English (en)\\n                ------------\\n                    \\n                  The quick brown fox jumps over the lazy dog\\n                    \\n                Spanish (es)\\n                ------------\\n                    \\n                  El pingÃ¼ino Wenceslao hizo kilÃ³metros bajo exhaustiva lluvia y\s\\n                  frÃ­o, aÃ±oraba a su querido cachorro.\\n                  (Contains every letter and every accent, but not every combination\\n                  of vowel + acute.)\\n                    \\n                French (fr)\\n                -----------\\n                    \\n                  Portez ce vieux whisky au juge blond qui fume sur son Ã®le intÃ©rieure, Ã \\n                  cÃ´tÃ© de l'alcÃ´ve ovoÃ¯de, oÃ¹ les bÃ»ches se consument dans l'Ã¢tre, ce\\n                  qui lui permet de penser Ã  la cÃ¦nogenÃ¨se de l'Ãªtre dont il est question\\n                  dans la cause ambiguÃ« entendue Ã  MoÃ¿, dans un capharnaÃ¼m qui,\\n                  pense-t-il, diminue Ã§Ã  et lÃ  la qualitÃ© de son Å“uvre.\s\\n                    \\n                  l'Ã®le exiguÃ«\\n                  OÃ¹ l'obÃ¨se jury mÃ»r\\n                  FÃªte l'haÃ¯ volapÃ¼k,\\n                  Ã‚ne ex aÃ©quo au whist,\\n                  Ã”tez ce vÅ“u dÃ©Ã§u.\\n                    \\n                  Le cÅ“ur dÃ©Ã§u mais l'Ã¢me plutÃ´t naÃ¯ve, LouÃ¿s rÃªva de crapaÃ¼ter en\\n                  canoÃ« au delÃ  des Ã®les, prÃ¨s du mÃ¤lstrÃ¶m oÃ¹ brÃ»lent les novÃ¦.\\n                    \\n                Irish Gaelic (ga)\\n                -----------------\\n                    \\n                  D'fhuascail Ãosa, Ãšrmhac na hÃ“ighe Beannaithe, pÃ³r Ã‰ava agus Ãdhaimh\\n                    \\n                Hungarian (hu)\\n                --------------\\n                    \\n                  ÃrvÃ­ztÅ±rÅ‘ tÃ¼kÃ¶rfÃºrÃ³gÃ©p\\n                  (= flood-proof mirror-drilling machine, only all non-ASCII letters)\\n                    \\n                Icelandic (is)\\n                --------------\\n                    \\n                  KÃ¦mi nÃ½ Ã¶xi hÃ©r ykist Ã¾jÃ³fum nÃº bÃ¦Ã°i vÃ­l og Ã¡drepa\\n                    \\n                  SÃ¦vÃ¶r grÃ©t Ã¡Ã°an Ã¾vÃ­ Ãºlpan var Ã³nÃ½t\\n                  (some ASCII letters missing)\\n                    \\n                Japanese (jp)\\n                -------------\\n                    \\n                  Hiragana: (Iroha)\\n                    \\n                  ã„ã‚ã¯ã«ã»ã¸ã¨ã¡ã‚Šã¬ã‚‹ã‚’\\n                  ã‚ã‹ã‚ˆãŸã‚Œãã¤ã­ãªã‚‰ã‚€\\n                  ã†ã‚ã®ãŠãã‚„ã¾ã‘ãµã“ãˆã¦\\n                  ã‚ã•ãã‚†ã‚ã¿ã—ã‚‘ã²ã‚‚ã›ã™\\n                    \\n                  Katakana:\\n                    \\n                  ã‚¤ãƒ­ãƒãƒ‹ãƒ›ãƒ˜ãƒˆ ãƒãƒªãƒŒãƒ«ãƒ² ãƒ¯ã‚«ãƒ¨ã‚¿ãƒ¬ã‚½ ãƒ„ãƒãƒŠãƒ©ãƒ \\n                  ã‚¦ãƒ°ãƒã‚ªã‚¯ãƒ¤ãƒ ã‚±ãƒ•ã‚³ã‚¨ãƒ† ã‚¢ã‚µã‚­ãƒ¦ãƒ¡ãƒŸã‚· ãƒ±ãƒ’ãƒ¢ã‚»ã‚¹ãƒ³\\n                    \\n                Hebrew (iw)\\n                -----------\\n                    \\n                  ? ×“×’ ×¡×§×¨×Ÿ ×©×˜ ×‘×™× ×××•×›×–×‘ ×•×œ×¤×ª×¢ ××¦× ×œ×• ×—×‘×¨×” ××™×š ×”×§×œ×™×˜×”\\n                    \\n                Polish (pl)\\n                -----------\\n                    \\n                  PchnÄ…Ä‡ w tÄ™ Å‚Ã³dÅº jeÅ¼a lub oÅ›m skrzyÅ„ fig\\n                  (= To push a hedgehog or eight bins of figs in this boat)\\n                    \\n                Russian (ru)\\n                ------------\\n                    \\n                  Ğ’ Ñ‡Ğ°Ñ‰Ğ°Ñ… ÑĞ³Ğ° Ğ¶Ğ¸Ğ» Ğ±Ñ‹ Ñ†Ğ¸Ñ‚Ñ€ÑƒÑ? Ğ”Ğ°, Ğ½Ğ¾ Ñ„Ğ°Ğ»ÑŒÑˆĞ¸Ğ²Ñ‹Ğ¹ ÑĞºĞ·ĞµĞ¼Ğ¿Ğ»ÑÑ€!\\n                  (= Would a citrus live in the bushes of south? Yes, but only a fake one!)\\n                    \\n                  Ğ¡ÑŠĞµÑˆÑŒ Ğ¶Ğµ ĞµÑ‰Ñ‘ ÑÑ‚Ğ¸Ñ… Ğ¼ÑĞ³ĞºĞ¸Ñ… Ñ„Ñ€Ğ°Ğ½Ñ†ÑƒĞ·ÑĞºĞ¸Ñ… Ğ±ÑƒĞ»Ğ¾Ğº Ğ´Ğ° Ğ²Ñ‹Ğ¿ĞµĞ¹ Ñ‡Ğ°Ñ\\n                  (= Eat some more of these fresh French loafs and have some tea)\s\\n                    \\n                Thai (th)\\n                ---------\\n                    \\n                  [--------------------------|------------------------]\\n                  à¹ à¹€à¸›à¹‡à¸™à¸¡à¸™à¸¸à¸©à¸¢à¹Œà¸ªà¸¸à¸”à¸›à¸£à¸°à¹€à¸ªà¸£à¸´à¸à¹€à¸¥à¸´à¸¨à¸„à¸¸à¸“à¸„à¹ˆà¸²  à¸à¸§à¹ˆà¸²à¸šà¸£à¸£à¸”à¸²à¸à¸¹à¸‡à¸ªà¸±à¸•à¸§à¹Œà¹€à¸”à¸£à¸±à¸ˆà¸‰à¸²à¸™\\n                  à¸ˆà¸‡à¸à¹ˆà¸²à¸Ÿà¸±à¸™à¸à¸±à¸’à¸™à¸²à¸§à¸´à¸Šà¸²à¸à¸²à¸£           à¸­à¸¢à¹ˆà¸²à¸¥à¹‰à¸²à¸‡à¸œà¸¥à¸²à¸à¸¤à¹…à¹€à¸‚à¹ˆà¸™à¸†à¹ˆà¸²à¸šà¸µà¸‘à¸²à¹ƒà¸„à¸£\\n                  à¹„à¸¡à¹ˆà¸–à¸·à¸­à¹‚à¸—à¸©à¹‚à¸à¸£à¸˜à¹à¸Šà¹ˆà¸‡à¸‹à¸±à¸”à¸®à¸¶à¸”à¸®à¸±à¸”à¸”à¹ˆà¸²     à¸«à¸±à¸”à¸­à¸ à¸±à¸¢à¹€à¸«à¸¡à¸·à¸­à¸™à¸à¸µà¸¬à¸²à¸­à¸±à¸Šà¸Œà¸²à¸ªà¸±à¸¢\\n                  à¸›à¸à¸´à¸šà¸±à¸•à¸´à¸›à¸£à¸°à¸à¸¤à¸•à¸´à¸à¸à¸à¸³à¸«à¸™à¸”à¹ƒà¸ˆ        à¸à¸¹à¸”à¸ˆà¸²à¹ƒà¸«à¹‰à¸ˆà¹Šà¸°à¹† à¸ˆà¹‹à¸²à¹† à¸™à¹ˆà¸²à¸Ÿà¸±à¸‡à¹€à¸­à¸¢ à¸¯\\n                    \\n                  [The copyright for the Thai example is owned by The Computer\\n                  Association of Thailand under the Royal Patronage of His Majesty the\\n                  King.]\\n                    \\n                Turkish (tr)\\n                ------------\\n                    \\n                  PijamalÄ± hasta, yaÄŸÄ±z ÅŸofÃ¶re Ã§abucak gÃ¼vendi.\\n                  (=Patient with pajamas, trusted swarthy driver quickly)\\n                    \\n                    \\n                Special thanks to the people from all over the world who contributed\\n                these sentences since 1999.\\n                    \\n                A much larger collection of such pangrams is now available at\\n                    \\n                  http://en.wikipedia.org/wiki/List_of_pangrams";
        String jsonString = "{\"longText\":\"" + longText + "\"}";

        JsonParser deserializer = new JsonParser();
        JsonNode test = deserializer.parse(jsonString);
        System.out.println(test);

        assertEquals(longText, test.get("longText").getValue());
    }
}